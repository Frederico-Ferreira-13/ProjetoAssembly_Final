@page
@model ProjetoAssembly_Final.Pages.create_recipeModel
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<ProjetoAssembly_Final.Pages.IndexModel> Localizer
@{
    Layout = "_Layout";
    ViewData["Title"] = Localizer["Crie a sua Receita"];
}

@section Styles {
    <link rel="stylesheet" href="~/css/pages/create-recipe.css" asp-append-version="true" />    
}

<div class="recipe-form-wrapper"> 
    <h1>@Localizer["Submeter Nova Receita"]</h1>

    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <form method="post" enctype="multipart/form-data">

        <div class="input-group">
            <label asp-for="Title">@Localizer["Nome da Receita"]</label>
            <input asp-for="Title" class="form-control-recipe" placeholder="@Localizer["Ex: Bacalhau à Brás Especial"]" required>
            <span asp-validation-for="Title" class="text-danger"></span>
        </div>

        <div class="input-group">
            <label asp-for="Description">@Localizer["Instruções de Preparação"]</label>
            <textarea asp-for="Description" class="form-control-recipe textarea-large" rows="5" placeholder="@Localizer["Descreva os passos detalhadamente..."]" required></textarea>
            <span asp-validation-for="Description" class="text-danger"></span>
        </div>

        <div class="form-row"> <div class="input-group flex-1">
                <label asp-for="SelectedCategory">@Localizer["Categoria"]</label>
                <select asp-for="SelectedCategory" class="form-control-recipe" required>
                    <option value="">@Localizer["Selecione.."]</option>
                    <option value="1">@Localizer["Entradas/Sopas"]</option>
                    <option value="2">@Localizer["Prato Principal"]</option>
                    <option value="3">@Localizer["Sobremesas"]</option>
                    <option value="4">@Localizer["Vegetariano"]</option>
                </select>
            </div>

            <div class="input-group flex-1">
                <label asp-for="SelectedDifficulty">@Localizer["Dificuldade"]</label>
                <select asp-for="SelectedDifficulty" class="form-control-recipe" required>
                    <option value="">@Localizer["Selecione.."]</option>
                    <option value="1">@Localizer["Fácil"]</option>
                    <option value="2">@Localizer["Médio"]</option>
                    <option value="3">@Localizer["Difícil"]</option>
                </select>
            </div>
        </div>

        <h3 class="section-title">@Localizer["Ingredientes"]</h3>
        <div id="ingredient-list" class="ingredients-section">
            <div class="ingredient-row">
                <input type="number" name="QuantityValue[]" class="form-control-recipe input-qty" placeholder="Qtd" step="0.01">
                <input type="text" name="Unit[]" class="form-control-recipe input-unit" placeholder="Unid.">
                <input type="text" name="IngredientName[]" class="form-control-recipe input-name" placeholder="@Localizer["Ingrediente"]" required>
                <input type="text" name="ingredientDetail[]" class="form-control-recipe input-detail" placeholder="@Localizer["Nota/Tipo"]" />
                              
                <button type="button" class="btn-remove-ingredient" onclick="this.parentElement.remove()" style="display:none;">
                    <i class="fa-solid fa-trash"></i>
                </button>
            <</div>
        </div>
        
        <button type="button" id="btn-add-ingredient">
            <i class="fa-solid fa-plus"></i> @Localizer["Adicionar Ingrediente"]
        </button>

        <div class="input-group image-upload-section">
            <label>@Localizer["Imagem da Receita"]</label>
            <input type="file" name="RecipeImage" class="form-control-recipe" accept="image/*">
        </div>      
        
        <button type="submit" class="btn-save-recipe">
            @if (User.IsInRole("Admin") || User.FindFirst(System.Security.Claims.ClaimTypes.Role)?.Value == "2")
            {
                 <i class="fa-solid fa-paper-plane"></i> @Localizer["Publicar Receita"]            
            }
            else
            {            
                <i class="fa-solid fa-save"></i> @Localizer["Guardar Receita"]            
            }
        </button>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" /> 
    <script src="~/js/ingredientes.js"></script>
}
