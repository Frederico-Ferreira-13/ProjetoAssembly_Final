@page
@model ProjetoAssembly_Final.Pages.PendingRecipesModel
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<ProjetoAssembly_Final.Pages.IndexModel> Localizer
@{
    ViewData["Title"] = "Receitas Pendentes";
}

@section Styles {
    <link rel="stylesheet" href="~/css/pages/pendingRecipes.css" asp-append-version="true" />
}

<div class="pending-container">
    <h1 class="section-title">
        <i class="fa-solid fa-clock-rotate-left"></i> @Localizer["Receitas Pendentes"]
    </h1>
</div>

@if(TempData["Success"] != null)
{
    <div class="alert-pending-info">
        <i class="fa-solid fa-circle-check"></i>@TempData["Success"]
    </div>
}

@if (Model.PendingRecipes.Any())
{
    <div class="grid-pending">
        @foreach (var recipe in Model.PendingRecipes)
        {
            <article class="card-pending">
                <span class="status-badge">A aguardar</span>
                <a href="/view_recipes/@recipe.RecipesId">
                    <img src="/img/@(string.IsNullOrEmpty(recipe.ImageUrl) ? "default.jpg" : recipe.ImageUrl)"
                         class="card-pending-img"
                         alt="@recipe.Title" />                      
                </a>

                <div class="card-pending-body">
                    <h3 class="card-pending-title">@recipe.Title</h3>

                    <div class="card-pending-meta">
                        <span><i class="fa-solid fa-user"></i> @(recipe.User?.UserName ?? "Utilizador")</span>
                        <span><i class="fa-solid fa-calendar-days"></i> @recipe.CreatedAt.ToString("dd/MM/yyyy")</span>
                    </div>

                    <div class="pending-actions">
                        <a href="/view_recipes/@recipe.RecipesId" class="btn-view-details" title="Rever Conteúdo">
                            <i class="fa-solid fa-eye"></i>    
                        </a>

                        <form method="post" asp-page-handler="Approve">
                            <input type="hidden" name="id" value="@recipe.RecipesId" />
                            <button type="submit" class="btn btn-success w-100">
                                <i class="fa-solid fa-check"></i> Autorizar
                            </button>
                        </form>
                    </div>
                </div>
            </article>
        }
    </div>
}
else
{
    <div class="alert alert-info text-center">
        Não há receitas pendentes de aprovação no momento.
    </div>
}            
