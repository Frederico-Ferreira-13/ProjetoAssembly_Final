@page
@model ProjetoAssembly_Final.Pages.recipesModel
@{
    Layout = "_Layout";
    ViewData["Title"] = "Explorar Receitas";
}

@section Styles {
    <link rel="stylesheet" href="~/css/recipe.css" asp-append-version="true" />
}

<div class="container-main">
    <section class="Categorias-home">
        <h2 class="section-title">Explorar Receitas</h2>

        <div class="grid-categorias">
            <a asp-page="/recipes" asp-route-categoryId="1" class="cat-card @(Request.Query["categoryId"] == "1" ? "active" : "")">
                <div class="cat-icon"><i class="fa-solid fa-bowl-food"></i></div>
                <span>Sopas</span>
            </a>
            <a asp-page="/recipes" asp-route-categoryId="2" class="cat-card @(Request.Query["categoryId"] == "2" ? "active" : "")">
                <div class="cat-icon"><i class="fa-solid fa-drumstick-bite"></i></div>
                <span>Carne</span>
            </a>
            <a asp-page="/recipes" asp-route-categoryId="3" class="cat-card @(Request.Query["categoryId"] == "3" ? "active" : "")">
                <div class="cat-icon"><i class="fa-solid fa-fish"></i></div>
                <span>Peixe</span>
            </a>
            <a asp-page="/recipes" asp-route-categoryId="4" class="cat-card @(Request.Query["categoryId"] == "4" ? "active" : "")">
                <div class="cat-icon"><i class="fa-solid fa-cake-candles"></i></div>
                <span>Sobremesas</span>
            </a>
            <a asp-page="/recipes" class="cat-card @(string.IsNullOrEmpty(Request.Query["categoryId"]) ? "active" : "")" style="background-color: #f8f9fa;">
                <div class="cat-icon"><i class="fa-solid fa-list"></i></div>
                <span>Todas</span>
            </a>
        </div>
    </section>

    <hr class="separator">

    <section class="destaques-home">
        <div id="container-receitas" class="grid-receitas">
            @if (Model.ListRecipes != null && Model.ListRecipes.Any())
            {
                @foreach (var receita in Model.ListRecipes)
                {
                    <article class="receitas-card">
                        <div class="card-img-container">
                            <button class="btn-fav" onclick="event.preventDefault(); toggleFavorite(this, @receita.RecipesId">
                                <i class="fa-regular fa-heart"></i>
                            </button>

                            <img src="/img/@(string.IsNullOrEmpty(receita.ImageUrl) ? "default.jpg" : receita.ImageUrl)" alt="@receita.Title">
                        </div>                      

                        <div class="card-info">
                            <span class="card-popularity">
                                <i class="fa-solid fa-heart"></i> @(receita.FavoriteCount ?? 0) favoritos
                            </span>

                            <h3>@receita.Title</h3>

                            <div class="recipe-meta">
                                @{
                                    var difClass = receita.DifficultyId == 1 ? "dif-facil" : (receita.DifficultyId == 2 ? "dif-media" : "dif-dificil");
                                    var difLabel = receita.DifficultyId == 1 ? "Fácil" : (receita.DifficultyId == 2 ? "Média" : "Difícil");
                                }
                                <span class="badge-dif @difClass">@difLabel</span>

                                <span>
                                    <i class="fa-regular fa-clock"></i>
                                    @(receita.PrepTimeMinutes + receita.CookTimeMinutes) min
                                </span>
                            </div>
                            
                            <a href="/view_recipes/@receita.RecipesId" class="btn">
                                Ver Receita
                            </a>
                        </div>
                    </article>
                }
            }
            else
            {
                <div class="aviso-vazio" style="grid-column: 1/-1; text-align: center; padding: 50px">
                    <i class="fa-solid fa-magnifying-glass" style="font-size: 3rem; color: #ccc;"></i>
                    <p style="margin-top: 15px;">Ainda não temos receitas nesta categoria.</p>
                    <a asp-page="/recipes" asp-route-categoryId="" class="btn-principal">Ver todas as receitas</a>
                </div>
            }
        </div>
    </section>
</div>
