@page
@model ProjetoAssembly_Final.Pages.perfilModel
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<ProjetoAssembly_Final.Pages.IndexModel> Localizer
@{
    Layout = "_Layout";
    ViewData["Title"] = Localizer["O Meu Perfil"];
}

@section Styles {
    <link rel="stylesheet" href="~/css/pages/perfil.css" asp-append-version="true" />
}

<div class="profile-container">
    <section class="profile-header">
        <div class="profile-flex">
            <<div class="profile-img-wrapper">
                <img src="~/img/user.icon.png" alt="Foto de Perfil" class="profile-img-large">
            </div>            
           
            <div class="user-info">
                <h1>@Localizer["Olá"], @(Model.CurrentUser?.UserName ?? Localizer["Utilizador"])!</h1>

                <p>@Localizer["Membro desde"]: @Model.CurrentUser?.CreatedAt.ToString("MMMM yyyy")</p>
                
                <a asp-page="/perfilEdit" class="btn-manage edit" style="max-width: 200px;">
                    <i class="fa-solid fa-user-gear"></i>@Localizer["Editar Dados"]
                </a>
                <div class="user-stats">
                    <div class="stat-item">
                        <span class="stat-value">@Model.TotalCreated</span>
                        <span class="stat-label">@Localizer["Criadas"]</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value">@Model.TotalFavorites</span>
                        <span class="stat-label">@Localizer["Favoritos"]</span>
                    </div>
                </div>
            </div>
        </div>
    </section>    

    <h2 class="section-subtitle">
        <i class="fa-solid fa-utensils"></i> @Localizer["As Minhas Receitas"]
    </h2>    

    <section class="profile-grid">
        @if(Model.MyRecipes != null && Model.MyRecipes.Any())
        {
            @foreach(var recipe in Model.MyRecipes)
            {
                <articl class="profile-recipe-card">
                    <img src="@(string.IsNullOrEmpty(recipe.ImageUrl) ? "/img/default.jpg" : recipe.ImageUrl)"
                         alt="@recipe.Title" class="profile-card-img">
                    
                    <div class="profile-card-info">
                        <h3>@recipe.Title</h3>

                        <div class="profile-actions">
                            <a href="/editRecipe?id=@recipe.RecipesId" class="btn-manage edit">
                                <i class="fa-solid fa-pen-to-square"></i> @Localizer["Editar"]
                            </a>

                            <button onclick="confirmDelete(@recipe.RecipesId)" class="btn-manage delete">
                                <i class="fa-solid fa-trash"></i> @Localizer["Apagar"]
                            </button>
                        </div>
                    </div>
                </articl> 
            }
        }
        else
        {
            <div class="empty-state-notice">
                <i class="fa-solid fa-utensils"></i>
                <p>@Localizer["Ainda não criaste nenhuma receita."]</p>
                <a asp-page="/create_recipe" class="btn-manage edit" style="display: inline-flex; width: auto;">
                    @Localizer["Criar a minha primeira receita"]
                </a>
            </div>
        }
    </section>
</div>

@section Scripts {
    <script>
        function confirmDelete(id) {
            if (confirm("Tem a certeza que deseja eliminar esta receita?")) {
                console.log("Eliminar receita ID: " + id);                
            }
        }
    </script>
}
